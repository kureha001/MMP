# Orange Picoで扱うには
OrangePicoで、MMPを利用する方法を解説します。

---
## 1. MMPとの接続
| Orange Pico | MMP                |
| ----------- | ------------------ |
| RXD         | GPIO0 (Serial1 TX) |
| TXD         | GPIO1 (Serial1 RX) |
| GND         | GND                |
| 3.3V        | 3.3V               |

---
## 2. 通信設定
書式：**uart** `<チャネル>`, `<モード>`, `<ボーレート>`
| 引数名         | 設定値                               |
| -------------- | ------------------------------------ |
| チャンネル     | 1(固定)                              |
| モード         | 0:エコーバック`なし`、キー入力`なし` |
|                | 1:エコーバック`あり`、キー入力`なし` |
|                | 2:エコーバック`なし`、キー入力`あり` |
|                | 3:エコーバック`あり`、キー入力`あり` |
| ボーレート     | 300～115200                          |

---
## 3. コマンドの送信
書式：**uartput** `<チャネル>`, `<文字列>`
**終端に"!" を必ず付ける仕様(ファームウェア)**。
| 引数名         | 設定値                     |
| -------------- | -------------------------- |
| チャンネル     | 1(固定)                    |
| 文字列         | ファームウェアの仕様を参照 |

---
## 4. コマンド戻り値の受信
書式：**uartget**(`<チャネル>`)
受信バッファーの**先頭のデータ**を取得します。
受信バッファーが空のときは-1を返します。
MMPからの戻り値を得るには、このコマンドを5回繰り返す必要があります。
| 引数名         | 設定値                     |
| -------------- | -------------------------- |
| チャンネル     | 1(固定)                    |

---
## 5. サンプルコード
### 00_共通部.BAS
[→ソースコード](./サンプル/00_共通部.BAS)
移行のソースコードの共通部です。
各サンプルソースコードの先頭にマージしてください。

###### (内容)
##### 100行目～：初期化処理
- プログラム全体使の初期化をします。
- プログラムを実行すると、最初に実行されます。
- 初期化が終わると、MMPコマンドの実行(1000行目)に進みます。
##### 200行目～：事前準備サブルーチン
- MMPコマンドの実行に関する準備をします。
##### 300行目～：ＵＡＲＴ処理サブルーチン
- ＵＡＲＴの送受信と結果表示をします。

### 10_ステータス取得.BAS
[→ソースコード](./サンプル/10_ステータス取得.BAS)<br>
※ 00_共通部.BAS を 先頭にマージしてください

以下のシステム状況を取得・表示します。
- ファームウェア
- ＰＷＭ機器(pca9685)
- ＭＰ３機器(DFPlayer)

### 20_デジタル入出力.BAS
[→ソースコード](./サンプル/20_デジタル入出力.BAS)<br>
※ 00_共通部.BAS を 先頭にマージしてください

以下のシステム状況を取得・表示します。
- ファームウェア
- ＰＷＭ機器(pca9685)
- ＭＰ３機器(DFPlayer)

### 21_アナログ入力.BAS
[→ソースコード](./サンプル/21_アナログ入力.BAS)<br>
※ 00_共通部.BAS を 先頭にマージしてください

アナログ値を取得・表示します。
- プレイヤー１のポートを読みとります
- ４つのスイッチを読み取ります

### 30_PWM.BAS
[→ソースコード](./サンプル/30_PWM.BAS)<br>
※ 00_共通部.BAS を 先頭にマージしてください

PWM出力します。
- Ch0にパルスを出力します
- Ch1に5V(一定)を出力します

### 40_MP3.BAS
[→ソースコード](./サンプル/30_MP3.BAS)<br>
※ 00_共通部.BAS を 先頭にマージしてください

複数のMP3ファイルを連続して再生してから、停止します。