# ６章 オブジェクト

オブジェクトは、コントローラ制御配下の有無で大別されます。

- **コントローラ制御配下ではないオブジェクト**：
  - **制御系**：<br>
    ゲーム全体の**進行を制御**するオブジェクトです。
    **コントローラ**がこれにあたります。
  - **データ系**：<br>
    さまざまな箇所で使う**データ集**のオブジェクトです。
    本システムでは、**データセット**オブジェクトと呼びます。
    **エンティティ系･管理系のオブジェクトをコンテナ**として持ちます。

- **コントローラ制御配下のオブジェクト**：
  - **エンティティ系**：<br>
    姿かたちがあり、プレイヤーからは**理解しやすい**オブジェクトです。
    ゲームに登場する**キャラクタなど**がこれに当たります。
  - **処理フロー系**：<br>
    姿かたちはなく、画面ごとの**処理の流れ･状況管理**を制御するオブジェクトです。
    **シーン**がこれにあたります。

---
### 6.1 コントローラ(制御系)
Pyxelのフレームごとに、以下の順序で処理します。
この順序は、**プロセス**という単位で区切ります。
プロセスでは、対象オブジェクトがもつ**プロセス用の機能**を実行します。

1. **変更コントーラ**：
   1. **入力走査**：<br>
      **MMPからの入力**を収集し、後続で利用できるように準備
   1. **BGM制御**：<br>
      BGMが終わったらリピート再生
   1. **プロセス実行**：<br>
     動作プロセスなど実行し、データを変更
     </br>

1. **結果コントーラ**：
   1. **プロセス実行**：<br>
     動作プロセスなど実行し、データを変更
      1. **表現**：<br>
        エンティティ系オブジェクトの状態を画面表示や物理的な物で表現
      1. **遷移**：<br>
        処理フロー系ブジェクトのシーン遷移を準備


---
### 6.2 データセット(データ系)
～執筆中～

---
### 6.3 キャラクタ(エンティティ系)
様々なキャラクタが考えられます。
敵・味方(自分)/敵のみ/自分のみ...など、さまざまです。
**コントローラ制御配下**なので、該当する**プロセス機能を要素クラス**として持ちます。
処理内容ごとにプロセス機能を用意するので、**多くのプロセス機能**(移動/発射/衝突･命中/通過など)を持つ場合があります。

---
### 6.4 シーン(処理フロー系)

**コントローラ制御配下**なので、該当する**プロセス機能を要素クラス**として持ちます。
プロセス機能は**表現･遷移**の2つを持ちます。

シーンオブジェクトは以下の3つがあります。
- **タイトル画面**：<br>
プレイ画面の事前設定と、プレイ開始指示
  - **表現プロセス**：<br>
    1. オープニングを表現
    1. プレイ条件の設定を受付
    1. プレイ開始の指示を受付
    1. プレイ画面への遷移要否を判定
  - **遷移プロセス**：<br>
    1. プレイ画面への遷移を準備
</br>

- **プレイ画面**：<br>
プレイヤーが生存中、ゲームを進行
  - **表現プロセス**：<br>
    1. ユーザにゲームプレイを提供
    1. 終了画面への遷移要否を判定
  - **遷移プロセス**：<br>
    1. 終了画面への遷移を準備
</br>

- **終了画面**：<br>
不要になったリソースを解放し、次のシーンへ移行
  - **表現プロセス**：<br>
    1. エンディングを表現
    1. タイトル画面への遷移要否を判定
  - **遷移プロセス**：<br>
    1. タイトル画面への遷移を準備

> シーンの遷移は、表現プロセスでデータセットに**要否を事前にセット**し、**遷移プロセスで実行**に移す点に注意

> 遷移準備では、次のシーンに必要な**リソース生成･初期値設定**をおこないます。
> つまり初期処理は、**1つ前のシーン**が担当するてんに注意
