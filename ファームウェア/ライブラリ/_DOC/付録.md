# MMP ライブラリ API マニュアル
## 付録

---
### A：プラットフォーム差分(要点)

| 項目 | .NET | Arduino | CPython | MicroPython | CircuitPython |
|---|---|---|---|---|---|
| 接続 API | `Connect(...)` | `ConnectAutoBaud / ConnectWithBaud` | 同左(Core 構成) | 同左 | 同左 |
| アダプタ初期化 | なし | なし | `CpyAdapter(port, preferred_ports)` | `MicroPyAdapter(uart_id, tx, rx)` | `CircuitPyAdapter(tx, rx, timeout_s, buffer_size)` |
| UART 指定 | OS 仮想 COM | ボード定義 | PC の物理/仮想 COM | `uart_id` 明示 | **ボード定義に依存**(`tx/rx`は無視される場合あり) |
| タイムアウト指定 | `Settings.*` | `Settings.*` | `Settings.*` | `Settings.*` | `Settings.*` + `timeout_s`(アダプタ) |
| 5 文字応答 | 全て共通(末尾 `!`) | 同左 | 同左 | 同左 | 同左 |
| エラー時戻り値(例) | 例外(C# Core)/ COM では既定値 | 0 or -1 | -1 or 0 | -1 or 0 | -1 or 0 |
| 表示ボーレート | 実測値 | 実測値(`ConnectedBaud()`) | **OS/ドライバ表示と一致しない場合あり(CDC 由来)** | 実測値 | 実測値 |

> **注**：CPython 環境では USB-CDC ドライバ/OS の都合で「表示上のボーレート」と「実際に接続したボーレート」が一致しない場合があります。通信そのものは `VER!` 応答で検証しています(付録 B 参照)。


---
### 付録 B：USB-CDC について

USB-CDC は、USB 上にシリアルポートを**擬似的に**提供する仕組みです。OS/ドライバや USB–UART ブリッジの実装により、**設定されたボーレート表示**と**実際のリンク条件**が一致しない／更新タイミングがずれることがあります。本ライブラリは**5 文字固定応答**(`VER!` 等)で**実通信の成立**を検証するため、表示の差異があっても動作が担保されます。

---
### 付録 C：.NET の COM API と DLL 直接参照の違い

- **DLL 直接参照(推奨)**：`Mmp.Core.MmpClient` をそのまま利用。C# / WPF / サービス等に最適。例外で失敗を通知。  
- **COM API(VBA 等)**：`Mmp.Com` を `CreateObject("Mmp.Com")` で生成。例外は `LastError` と戻り値に集約。Excel VBA / Access などレガシー環境に最適。  
- **コマンド仕様**や API 名は**同一**(呼び出し層のエラーハンドリングが異なる)。