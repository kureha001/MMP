# SDカードコピーツール（Tkinter版）

## 概要
本ツールは **Windows 専用** のSDカードコピーアプリです。</BR>
実行時カレントディレクトリ直下の **`FDPlayer`** フォルダ内の全内容（ファイル・サブフォルダ）を、選択したSDカードのルート直下にコピーします。

コピー前に任意で **FAT32形式のフォーマット** が可能です。</BR>
フォーマットを行った場合のみ、ボリュームラベルを **`FDPLAYER`** に設定します。</BR>  
コピー中は進行状況バーで進捗を表示し、完了後に安全取り外しも実行できます。</BR>

---

## 画面イメージ

### メイン画面
![SDカードコピーツール メイン画面](images/sdcard001.png)

---

## 主な機能

- SDカードの自動検出とリスト表示（ドライブレター・ボリュームラベル・容量情報を表示）
- 選択したSDカードへのフォーマット（FAT32固定・クイックフォーマット）
- **フォーマット時のみ** ボリュームラベルを `FDPLAYER` に設定
- `FDPlayer` フォルダ内の**中身**をSDカードのルート直下へ再帰コピー
- コピー進行状況のリアルタイム表示（%・速度・ETA）
- コピー後の安全取り外し

---

## 動作仕様

### コピー元
- 実行時カレントディレクトリ直下の `FDPlayer` フォルダ固定
- 存在しない場合はエラー表示
- コピー対象は直下ファイルおよびサブフォルダを含む全内容

### コピー先
- 選択したSDカードのルート直下
- 既存ファイルは上書き
- コピー元フォルダ名は作らず中身のみ展開

### フォーマット
- チェックボックスで選択可能（任意）
- FAT32形式固定
- フォーマット時のみラベルを `FDPLAYER` に設定
- **確認方法**: 「はい／いいえ」のダイアログ（`messagebox.askyesno`）で最終確認します  
  ※ 以前の「ドライブレター再入力」「'FORMAT' タイプ」は不要になりました。

### コピー
- 進行状況バーで進捗率をリアルタイム表示
- 速度（MB/s）と残り時間を表示
- 空き容量不足時はエラー表示

### 安全取り外し
- コピー完了後に自動実行（オプション）
- PowerShell または COM API を使用して安全に取り外し

---

## 必要環境
- **OS**: Windows 10 / 11
- **Python**: 3.8 以降
- **モジュール**: 標準ライブラリのみ（Tkinter含む）
- SDカードリーダーが認識されていること

---

## 実行方法
1. `FDPlayer` フォルダをスクリプトと同じフォルダに置く  
   （このフォルダの**中身**がコピーされます）
2. スクリプト（例: `sd_copy_gui.py`）をダブルクリックで起動
3. GUIで以下を操作
   - **SDカード選択**（プルダウン）
   - 必要に応じて「フォーマット」をチェック（FAT32固定／ラベル `FDPLAYER`）
   - 必要に応じて「コピー後に安全取り外し」をチェック
   - 「コピー開始」をクリック
4. フォーマットを選択している場合、**「はい／いいえ」**確認ダイアログが表示されます  
   「はい」で続行、「いいえ」で中止します。
5. 進捗バーが 100% になり、完了ダイアログが表示されます。

---

## 注意事項
- FAT32には **1ファイル 4GB 未満** の制限があります
- フォーマットを行うとSDカード内のデータは完全に消去されます
- 既存ファイルは上書きされます
- 管理者権限での実行推奨（フォーマット・安全取り外し成功率向上）