# IchigoJamで扱うには

IchigoJam Type-R/Pで、MMPを利用する方法を解説します。

---
## 1. MMPとの接続
| IchigoJam  | MMP                |
| ---------- | ------------------ |
| RXD        | GPIO0 (Serial1 TX) |
| TXD        | GPIO1 (Serial1 RX) |
| GND        | GND                |
| 3.3V       | 3.3V               |

---
## 2. 通信設定
**2-1. ボーレート設定** 
**書式：BPS** `<ボーレート>`
3つのプリセットと、任意の 1万 bps以上 を指定できます。
| 引数名         | 設定値                       |
| -------------- | ---------------------------- |
| ボーレート     | **0** : 115,200bps (初期値) |
|                | **1** : 57600bps            |
|                | **2** : 38400bps            |
|                | **-100以下** : -100倍のbps  |


**2-2. ＵＡＲＴモード切替** 
**書式：UART** `<モード>`
通常の画面表示／ＵＡＲＴの2つのモードを切り替えます。
- 画面表示命令を用いて、UARTの`送信`を行います。
- キー入力命令を用いて、UARTの`受信`を行います。

| 引数名 | 設定値                       |
| ------ | ---------------------------- |
| モード | **0** : UARTを無効<br>(画面表示・キー入力の命令は通常機能に移行)|
|        | **1** : UARTを有効<br>(画面表示・キー入力の命令はUART機能に移行)|

---
## 3. コマンドの送信
書式：**PRINT** "`<文字列>`"
書式：**?** "`<文字列>`"
`UART1`後にこの命令で送信します。
| 引数名         | 設定値                     |
| -------------- | -------------------------- |
| 文字列         | ファームウェアの仕様を参照 |

---
## 4. コマンド戻り値の受信
書式：**INPUT**()
`UART1`後にこの命令で受信します。
受信バッファーの**先頭のデータ**を取得します。
受信バッファーが空のときは **？確認中？** を返します。
MMPからの戻り値を得るには、このコマンドを5回繰り返す必要があります。

---
## 5. サンプルコード
### 00_ステータス取得.BAS
[→ソースコード](./サンプル/00_ステータス取得.BAS)

以下のシステム状況を取得・表示します。
- ファームウェア
- ＰＷＭ機器(pca9685)
- ＭＰ３機器(DFPlayer)

### 10_デジタル入出力.BAS
[→ソースコード](./サンプル/10_デジタル入出力.BAS)

以下のシステム状況を取得・表示します。
- ファームウェア
- ＰＷＭ機器(pca9685)
- ＭＰ３機器(DFPlayer)

### 11_アナログ入力.BAS
[→ソースコード](./サンプル/11_アナログ入力.BAS)

アナログ値を取得・表示します。
- プレイヤー１のポートを読みとります
- ４つのスイッチを読み取ります

### 20_PWM.BAS
[→ソースコード](./サンプル/20_PWM.BAS)

PWM出力します。
- Ch0にパルスを出力します
- Ch1に5V(一定)を出力します

### 30_MP3.BAS
[→ソースコード](./サンプル/30_MP3.BAS)

複数のMP3ファイルを連続して再生してから、停止します。