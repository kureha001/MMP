# MMP Python Core 分割アーキテクチャ要約

## 1. 目的
- 「小さなファイル＋限定責務」で可読性・保守性・テスト容易性を向上
- ファームウェア側のモジュール構造とミラー化して対比・保守を容易に

## 2. 役割と責務
| ファイル | 役割 |
|-----------|------|
| **mmp_core.py** | Facade(入口)。<br>内部は各モジュールへ委譲。 |
| **mmp_core_INF.py** | `class _Info` |
| **mmp_core_ANA.py** | `class _Analog` |
| **mmp_core_DIG.py** | `class _Digital` |
| **mmp_core_PWM.py** | `class _PWM` |
| **mmp_core_I2C.py** | `class _I2C` |
| **mmp_core_MP3.py** | `class _MP3` |
| **mmp_com.py**       | 共通ヘルパ一|

## 3. 依存関係の原則
```
mmp_core.py（Facade）
   └─ import → mmp_core_*.py（各モジュール）
             └─ import → mmp_com.py（共通ヘルパ）
```
- 逆方向の参照は禁止（COMや各モジュールからFacadeを参照しない）
- import時の副作用なし（接続などは明示メソッドのみ）

## 4. 互換ポリシー
- 既存のクラス名／メソッド名／引数／戻り値／例外：一切変更なし
- Facadeで従来APIをそのまま再提供（内部委譲）

## 5. 拡張（新コマンド・新モジュール）
- 既存のAPI互換は維持しつつ、モジュール側にメソッドを追加するだけで拡張可能
- Facadeは無改修で増減に対応

## 6. 性能・信頼性
- 委譲コストは数十µs級（UART往復ms級の支配に対し無視可能）
- COM集中により重複バグ・修正漏れを排除

## 7. テスト容易性
- モジュール単位のユニットテストが可能（COMをモック可）
- 分割前後のレグレッションは代表1コール比較で済む

## 8. 運用ガイド
- 「送受信や応答判定を追加したい」→ COMにだけ加える
- 「機能を追加したい」→ 該当モジュールにメソッドを足す（Facadeは触らない）
- 「仕様変更に追従」→ ファーム側モジュールに合わせて同名ファイルを修正

---
**最終更新**：2025-10-10
