# データ設計
オブジェクトには、**静的･動的なデータを明確に分離**します。
併せて、コーディング**箇所が散在しない**よう、ルールを定めています。

---
### 7.1 ライフサイクルによる区分

静的なデータは**仕様**、動的なデータは**情報**という名称の**要素で分類**します。
"**変数の値を変更してよいのか?**"を この名称(**仕様/情報**)で見分けられます。

- **静的データ**：
  固定のパラメータや設計情報を保持します。
  専用のクラスを設けて変数定義し、**仕様**という名称で、実体化します。
</br>

- **動的データ**：
  実行中に変化する可変データを保持。
  専用のクラスを設けて変数定義し、**情報**という名称で、実体化します。

**（例：エンティティ系）**
```mermaid
classDiagram
class カモロボ {
  +仕様 : 仕様
  +情報 : 情報
  +FN動作 : 動作
  +FN命中 : 命中
  +FN表現 : 表現
}

class 仕様 {
  +最大速度 : float
  +燃料上限 : int
  +武装種別 : str
}
class 情報 {
  +現在速度 : float
  +燃料残量 : int
  +位置 : tuple
}

class 動作 {
  +仕様 : 動作_仕様
  +情報 : 動作_情報
  +実行() void
  +Fn選択_標的数() void
}
class 動作_仕様 {
  +加速度 : float
  +旋回速度 : float
}
class 動作_情報 {
  +移動中 : bool
  +旋回方向 : int
}

class 命中 {
  +仕様 : 命中_仕様
  +情報 : 命中_情報
  +実行() void
  +Fnリアクションを開始() void
}
class 命中_仕様 {
  +爆発時間 : float
  +エフェクト種類 : str
}
class 命中_情報 {
  +命中判定済み : bool
  +被弾位置 : tuple
}

class 表現 {
  +仕様 : 表現_仕様
  +情報 : 表現_情報
  +実行() void
  +Fn状態() void
  +Fn状態_物理体() void
  +Fn状態_画面() void
  +Fn状態_画面_背景() void
}
class 表現_仕様 {
  +色 : str
  +モデル形状 : str
}
class 表現_情報 {
  +現在アニメ : str
  +描画座標 : tuple
}

カモロボ *-- 仕様
カモロボ *-- 情報
カモロボ *-- 動作
カモロボ *-- 命中
カモロボ *-- 表現

動作 *-- 動作_仕様
動作 *-- 動作_情報
命中 *-- 命中_仕様
命中 *-- 命中_情報
表現 *-- 表現_仕様
表現 *-- 表現_情報

動作 ..> 仕様 : 参照(親)
動作 ..> 情報 : 参照(親)
命中 ..> 仕様 : 参照(親)
命中 ..> 情報 : 参照(親)
表現 ..> 仕様 : 参照(親)
表現 ..> 情報 : 参照(親)
```
---
**（例：タイトル画面シーン）**
```mermaid
classDiagram
class タイトル画面_本体 {
  +仕様 : 仕様
  +情報 : 情報
  +FN動作 : 動作
  +FN表現 : 表現
  +FN遷移 : 遷移
}

class 仕様
class 情報

class 動作 {
  +仕様 : 動作_仕様
  +情報 : 動作_情報
  +実行() void
  +Fn選択_標的数() void
}
class 動作_仕様 {
  +標的数選択一覧 : dict
}
class 動作_情報

class 表現 {
  +仕様 : 表現_仕様
  +情報 : 表現_情報
  +実行() void
  +Fn画面() void
  +Fn物理体() void
}
class 表現_仕様
class 表現_情報

class 遷移 {
  +仕様 : 遷移_仕様
  +情報 : 遷移_情報
  +実行() void
  +Fnゲーム情報を初期化() void
  +Fnオブジェクトを初期化() void
  +Fn物理体を初期化() void
  +Fn音声を再生() void
}
class 遷移_仕様
class 遷移_情報

タイトル画面_本体 *-- 仕様
タイトル画面_本体 *-- 情報
タイトル画面_本体 *-- 動作
タイトル画面_本体 *-- 表現
タイトル画面_本体 *-- 遷移

動作 *-- 動作_仕様
動作 *-- 動作_情報
表現 *-- 表現_仕様
表現 *-- 表現_情報
遷移 *-- 遷移_仕様
遷移 *-- 遷移_情報

%% 親(本体)の仕様/情報を参照（_仕様/_情報は属性として持たせず依存で明示）
動作 ..> 仕様 : 参照(親)
動作 ..> 情報 : 参照(親)
表現 ..> 仕様 : 参照(親)
表現 ..> 情報 : 参照(親)
遷移 ..> 仕様 : 参照(親)
遷移 ..> 情報 : 参照(親)

```
---
**（例：データセット）**
```mermaid
classDiagram
%% ルート：データセット（DS.pyでのまとめ役）
class データセット {
  +コンテナ : コンテナ
  +仕様 : 仕様_本体
  +情報 : 情報_本体
}

%% コンテナ（ルートの入れ物）
class コンテナ {
  +シーン : dict
  +カモロボ : list
}

%% 仕様ツリー
class 仕様_本体 {
  +システム : システム
  +シーンID : シーンID
  +プレイ時間 : int
  +BGM : BGM
  +リソース : リソース
  +ハード : ハード
}
class システム {
  +番号 : int
  +名称 : str
  +版数 : str
}
class シーンID {
  +タイトル画面 : int
  +プレイ画面 : int
  +終了画面 : int
}
class ハード {
  +HC4067の個数 : int
  +HC4067のCh数 : int
  +HC4067の丸め : int
}
class リソース {
  +画面 : リソース_画面
}
class リソース_画面 {
  +幅 : int
  +高 : int
}
class BGM {
  +レベル一覧 : dict
  +通常 : dict
  +規定音量 : int
  +ファイルNo一覧 : list
}

%% 情報（ランタイム）
class 情報_本体 {
  +シーン : any
  +遷移要否 : bool
  +プレイ時間 : int
  +得点 : list
  +標的数 : int
}

%% 関係
データセット *-- コンテナ
データセット *-- 仕様_本体
データセット *-- 情報_本体

仕様_本体 *-- システム
仕様_本体 *-- シーンID
仕様_本体 *-- BGM
仕様_本体 *-- リソース
仕様_本体 *-- ハード
リソース *-- リソース_画面
```

---
### 7.2 実装箇所の違い

使用するスコープに応じて、実装するレベルを決めます。
レベルにより、コーディング箇所が決まります。

- **データセット**:<br>
  アクセスが、ゲーム全体など多岐にわたる場合
- **コンポジットクラス**:<br>
  アクセスが、当該クラスの要素クラス横断的な場合
- **要素クラス**:<br>
  アクセスが、当該要素クラスに限られる場合
